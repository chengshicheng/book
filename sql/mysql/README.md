# 数据库

大体来说，MySQL可以分为**Server层**和**存储引擎层**两部分

Server层

```
1.连接器。建立连接和身份认证
2.查询缓存。命中缓存则直接返回结果，8.0版本后去掉了缓存
3.分析器。词法分析、语法分析，分析关键字、表名列名等是否满足语法
4.优化器。执行计划生成和索引选择
5.执行器。判断对该表的执行权限，操作引擎，返回结果
```

**存储引擎层**

引擎层负责数据的存储和提取。其架构模式是插件式的,支持 InnoDB 、 MyISAM 、Memory 等多个存储引擎，执行 create table 建表的时候，如果不指定引擎类型，默认使用的就是 InnoDB，不同的存储引擎共用一个 Server 层

Innodb和Myisam区别：

```
1.Innodb支持事务、外键、行锁，Myisam是表锁，并发性低
2.InnoDB不保存表行数，count需要扫描全表，MyISAM用一个变量保存，直接读取该值
3.InnoDB 是聚集索引，MyISAM 是非聚集索引。因此 InnoDB 必须要有主键
4.InnoDB的表数据都保存在独立的ibd文件中，MyISAM分成表定义(.frm)、数据(.MYD)、索引(.MYI)三个文件
5.InnoDB有完善的崩溃恢复机制，MyISAM崩溃后无法安全恢复
```

