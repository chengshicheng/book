- [drop、truncate、 delete区别](#drop-truncate--delete--)
- [数据库三范式是什么?](#----------)
- [union和union all有什么不同?](#union-union-all------)
- [乐观锁和悲观锁的区别](#----------)
- [加锁要注意什么？](#--------)

##### drop、truncate、 delete区别

```
1.drop 与 truncate是DDL，执行后会自动提交；delete是DML，有log可以进行回滚
2.delete是逐行删除，可加where条件。
3.truncate是删除所有数据，保留表结构后自增id置0
4.drop删除表结构和数据，释放表占用的所有空间
```

##### 数据库三范式是什么?

```
1NF确保每列保持原子性，不可再分解
2NF确保每列保持原子性，并且不存在对主键的部分函数依赖
3NF在2NF的基础上，不存在属性对主键的传递依赖
```

##### union和union all有什么不同?

```
1.union 执行会删除重复的记录，所有返回的行都是唯一
2.union all 不会删除重复行，也不对结果进行自动排序
```

#####  乐观锁和悲观锁的区别

- 乐观锁。总是假设最好的情况，每次去拿数据的时候都认为别人不会修改，所以不会上锁，但是在更新的时候会判断一下在此期间别人有没有去更新这个数据，可以使用版本号、时间戳和CAS算法实现

- 总是假设最坏的情况，认为别人会修改，所以每次在拿数据的时候都会上锁（select *** for update）

##### 加锁要注意什么？

```
没走索引：RC会先锁表，server层释放不满足的行锁，RR下会锁全表
没有数据：走了索引但是没有命中数据，不会锁表
命中聚簇索引：在对应聚簇索引上加行锁
命中二级唯一索引：会锁住二级索引和聚簇索引所在行
命中二级非唯一索引：RC时会锁住二级索引和聚簇索引所在行，RR时还会在二级索引前后加GAP锁
```

6. 

   

   

   